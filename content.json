{"meta":{"title":"逆水行舟","subtitle":null,"description":null,"author":"hbiboluo","url":"http://www.hbiboluo.com"},"pages":[{"title":"关于我","date":"2018-10-24T08:23:44.000Z","updated":"2018-10-24T09:10:56.167Z","comments":false,"path":"about/index.html","permalink":"http://www.hbiboluo.com/about/index.html","excerpt":"","text":"biboluo昵称来源于霹雳布袋戏之「赮毕钵罗」，《霹雳开天记之创神篇》初登场。其中，「毕钵罗」乃菩提树的别名，为平朔新月城之王受「侠菩提」之托交给「赮毕钵罗」的菩提子，以承接其未完成的天命。 从业以来，主要使用Java和Python，业务系统、开发工具、AI平台皆有些许涉足，经验不深不浅，知识还暂时不够体系化，「逆水行舟」，记录、分享自己的相关整理。 不敢说学过阳明心学，怕自己的浅薄反傍了心学，对佛学亦感兴趣。"}],"posts":[{"title":"程序猿Mac、Linux工具推荐","slug":"productivity","date":"2018-01-04T16:00:00.000Z","updated":"2018-10-24T09:43:12.834Z","comments":true,"path":"2018/01/05/productivity/","link":"","permalink":"http://www.hbiboluo.com/2018/01/05/productivity/","excerpt":"","text":"程序猿 5星 Shadowsocks: 科学上网 5星 Spacemacs: Vim + Emacs 5星 Dash「Mac Only」: 查阅API文档必备，结合Alfred食用效果更佳 5星 Proxifier「Mac Only」: 应用即使没有Proxy设置依然可以科学上网 5星 JupyterLab: Python必备 5星 Tampermonkey: Chrome插件，Hack网页必备 终端 5星 iTerm「Mac Only」: Mac下很爽的终端程序 5星 oh-my-zsh: 终端增强，自动补全…… 5星 htop: 服务器进程管理小能手 5星 tmux: 结合oh-my-zsh的插件，ta直接attach到指定会话 5星 mosh: 长时间连接server必备，断线自动恢复 5星 tldr: 指令的快速查询手册，Too Long Don’t Read. 效率 5星 Alfred「Mac Only」: 强力推荐 其他 6星 Anki: 记忆工具，强烈推荐，可多平台同步使用！！！ 5星 网易云音乐 5星 脑图工具：MindNode、XMind、FreeMind","categories":[{"name":"其他","slug":"其他","permalink":"http://www.hbiboluo.com/categories/其他/"}],"tags":[{"name":"效率","slug":"效率","permalink":"http://www.hbiboluo.com/tags/效率/"}]},{"title":"Xposed快速指南","slug":"quick-start-xposed","date":"2017-08-09T16:00:00.000Z","updated":"2018-10-24T09:27:23.622Z","comments":true,"path":"2017/08/10/quick-start-xposed/","link":"","permalink":"http://www.hbiboluo.com/2017/08/10/quick-start-xposed/","excerpt":"","text":"Xposed是什么Xposed是一个动态修改Android运行时的框架。 “Zygote”进程「Android运行时核心」是在手机启动时由/init.rc脚本启动，由/system/bin/app_process加载所有classes并调用初始化方法。 而Xposed框架被安装后，一个扩展的app_process会被安装到/system/bin/目录，将添加额外的jar包/data/data/de.robv.android.xposed.installer/bin/XposedBridge.jar到classpath并在指定位置调用方法。XposedBridge进入了类加载的世界，就可以主宰VM了。 XposedBridge中的hookMethodNative方法是Xposed入口，调用handleHookedMethod处理具体逻辑，传递method信息，可以回调注册过该method的hook方法，对参数进行修改，修改运行结果等等。 环境准备 开发环境: Android Studio Xposed API精要de.robv.android.xposed包下的hook入口： IXposedHookZygoteInit: Zygote进程初始化Hook，一般Android启动时使用。 IXposedHookLoadPackage: 应用(Package)加载Hook，一般用于Hook特定应用的一些方法。 IXposedHookInitPackageResources: 当应用加载资源时的Hook. 而重要的一些方法都在de.robv.android.xposed.XposedHelpers类中，比如提供的findAndHookMethod可以hook方法，其中参数类型： Class全限定名 ClassLoader 方法名称 可变长的方法参数类型(class/class全限定名称string) Hook逻辑 de.robv.android.xposed.XC_MethodHook为before/after的hook. de.robv.android.xposed.XC_MethodReplacement为方法替换hook，可以通过returnConstant方法返回结果，或者使用replaceHookedMethod直接修改。 其中，被Hook的方法参数: de.robv.android.xposed.XC_MethodHook.MethodHookParam setResult和setThrowable方法可以修改返回值，注意当在before hook执行则跳过执行原方法。 thisObject可以获得当前对象 Xposed快速开发流程第一步：添加Xposed依赖已被发布到Bintray/jCenter中, 直接添加一个Gradle dependency即可。1234567repositories &#123; jcenter();&#125;dependencies &#123; provided 'de.robv.android.xposed:api:82'&#125; 第二步: 在AndroidManifest.xml添加Xposed模块声明如下，比较简单，不展开解析：） 12345678910111213141516171819202122&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;manifest xmlns:android=\"http://schemas.android.com/apk/res/android\" package=\"de.robv.android.xposed.mods.tutorial\" android:versionCode=\"1\" android:versionName=\"1.0\" &gt; &lt;uses-sdk android:minSdkVersion=\"15\" /&gt; &lt;application android:icon=\"@drawable/ic_launcher\" android:label=\"@string/app_name\" &gt; &lt;meta-data android:name=\"xposedmodule\" android:value=\"true\" /&gt; &lt;meta-data android:name=\"xposeddescription\" android:value=\"Easy example which makes the status bar clock red and adds a smiley\" /&gt; &lt;meta-data android:name=\"xposedminversion\" android:value=\"53\" /&gt; &lt;/application&gt;&lt;/manifest&gt; 第三步：编写Xposed Module代码逻辑1. 了解你需要hook的对象这一步才是真正考验的地方，如果能拿到源码就直接阅读源码吧，以下只讨论通过apk逆向工程的情况。以下步骤可跳着看:) 获取应用的package name以下两个方案是从目前运行的app中获取，如果你已经获取了apk，也可以查看AndroidManifest.xml获得： 方法一：通过adb shell的package manager获取所有package，方便但是仍然得猜1adb shell pm list package 方法二：打开应用后通过adb shell的dumpsys获得当前系统服务数据。请参考文末的参考文档了解具体用法。1234# 通过window服务adb shell dumpsys window w | grep mCurrentFocus# 或者通过activity服务adb shell dumpsys activity | grep -A 5 \"Stack #1:\" | grep Intent 获取应用的apk包，以便反编译这个途径也比较多，直接从应用商店下载也是不错的选项，如果不方便下载的，直接通过pm的list package -f查看，再通过pull从手机端同步apk到PC端。示例，假设我们要获取小米应用商店的apk包: 12adb shell pm list package -f | grep com.xiaomi.marketadb pull /system/app/MiuiSuperMarket/MiuiSuperMarket.apk ~/Downloads/ 反编译apk查看代码理解(略)这一块内容比较杂，可以google一下，mac用户可以使用Android Crack Tool进行反编译。 阅读反编译后的代码，理解关键逻辑，制定Hook方案TODO 2. 编写Hook代码TODO 第四步：编写assets/xposed_init，注册Module类以便xposed framework了解，每行一个全限定类名即可 第五步：打包安装，在Framework中启用Module并设置后重启即可TODO 参考 官方Wiki API参考文档 dumpsys的用法","categories":[{"name":"技术","slug":"技术","permalink":"http://www.hbiboluo.com/categories/技术/"}],"tags":[{"name":"快速指南","slug":"快速指南","permalink":"http://www.hbiboluo.com/tags/快速指南/"},{"name":"Android","slug":"Android","permalink":"http://www.hbiboluo.com/tags/Android/"},{"name":"Xposed","slug":"Xposed","permalink":"http://www.hbiboluo.com/tags/Xposed/"}]}]}